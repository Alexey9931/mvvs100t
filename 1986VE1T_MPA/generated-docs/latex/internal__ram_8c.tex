\hypertarget{internal__ram_8c}{}\doxysection{Файл internal\+\_\+ram.\+c}
\label{internal__ram_8c}\index{internal\_ram.c@{internal\_ram.c}}


Файл с реализацией A\+PI для работы с областью памяти внутреннего ОЗУ  


{\ttfamily \#include \char`\"{}internal\+\_\+ram.\+h\char`\"{}}\newline
Граф включаемых заголовочных файлов для internal\+\_\+ram.\+c\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{internal__ram_8c__incl}
\end{center}
\end{figure}
\doxysubsection*{Функции}
\begin{DoxyCompactItemize}
\item 
uint8\+\_\+t $\ast$ \mbox{\hyperlink{internal__ram_8c_a9900c57ec6823ee4290b04f672955b20}{malloc\+\_\+ram\+\_\+pages}} (uint32\+\_\+t size)
\begin{DoxyCompactList}\small\item\em Выделяет свободную память во внутреннем ОЗУ (страницы памяти) -\/ необходима для реализации кучи \end{DoxyCompactList}\item 
void \mbox{\hyperlink{internal__ram_8c_a2a9582faad7484219e8715785b5ecde5}{free\+\_\+ram\+\_\+pages}} (uint8\+\_\+t $\ast$page\+\_\+addr, uint32\+\_\+t size)
\begin{DoxyCompactList}\small\item\em Освобождает память во внутреннем ОЗУ (страницы памяти) -\/ необходима для реализации кучи \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Переменные}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{internal__ram_8h_a628e9e5cf3cfb53a3445c0b68df42b0c}{int\+\_\+ram\+\_\+heap}} $\ast$ \mbox{\hyperlink{internal__ram_8c_a621e270e74e7cd76f8a307554fecc7f4}{heap\+\_\+ptr}}
\begin{DoxyCompactList}\small\item\em Указатель на \char`\"{}самодельную\char`\"{} кучу \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Подробное описание}
Файл с реализацией A\+PI для работы с областью памяти внутреннего ОЗУ 



\doxysubsection{Функции}
\mbox{\Hypertarget{internal__ram_8c_a2a9582faad7484219e8715785b5ecde5}\label{internal__ram_8c_a2a9582faad7484219e8715785b5ecde5}} 
\index{internal\_ram.c@{internal\_ram.c}!free\_ram\_pages@{free\_ram\_pages}}
\index{free\_ram\_pages@{free\_ram\_pages}!internal\_ram.c@{internal\_ram.c}}
\doxysubsubsection{\texorpdfstring{free\_ram\_pages()}{free\_ram\_pages()}}
{\footnotesize\ttfamily void free\+\_\+ram\+\_\+pages (\begin{DoxyParamCaption}\item[{uint8\+\_\+t $\ast$}]{page\+\_\+addr,  }\item[{uint32\+\_\+t}]{size }\end{DoxyParamCaption})}



Освобождает память во внутреннем ОЗУ (страницы памяти) -\/ необходима для реализации кучи 

Функция освобождения памяти во внешнем ОЗУ (страниц памяти) 
\begin{DoxyCode}{0}
\DoxyCodeLine{49 \{}
\DoxyCodeLine{50     uint32\_t page\_num = size/\mbox{\hyperlink{internal__ram_8h_a7d467c1d283fdfa1f2081ba1e0d01b6e}{PAGE\_SIZE}} + 1; \textcolor{comment}{// Кол-\/во освобождаемых страниц}}
\DoxyCodeLine{51     uint32\_t page\_cnt; \textcolor{comment}{// Счетчик страниц}}
\DoxyCodeLine{52      }
\DoxyCodeLine{53     \textcolor{keywordflow}{for} (page\_cnt = 0; (page\_cnt + page\_num) < \mbox{\hyperlink{internal__ram_8h_a7d467c1d283fdfa1f2081ba1e0d01b6e}{PAGE\_SIZE}}; page\_cnt++)}
\DoxyCodeLine{54     \{}
\DoxyCodeLine{55         \textcolor{keywordflow}{if} (page\_addr == \&\mbox{\hyperlink{internal__ram_8c_a621e270e74e7cd76f8a307554fecc7f4}{heap\_ptr}}-\/>\mbox{\hyperlink{structheap__struct_ab5c0c2d3e10e4006b923fc5b13a0ee68}{memory\_page\_space}}[page\_cnt][\mbox{\hyperlink{internal__ram_8h_a7d467c1d283fdfa1f2081ba1e0d01b6e}{PAGE\_SIZE}}])}
\DoxyCodeLine{56         \{}
\DoxyCodeLine{57             \textcolor{comment}{// Обновляем статус страниц}}
\DoxyCodeLine{58             \textcolor{keywordflow}{for} (uint32\_t i = 0; i < page\_num; i++)}
\DoxyCodeLine{59             \{}
\DoxyCodeLine{60                 memset(\&\mbox{\hyperlink{internal__ram_8c_a621e270e74e7cd76f8a307554fecc7f4}{heap\_ptr}}-\/>\mbox{\hyperlink{structheap__struct_ad0015b8e38985ffcc758c33e5fab5767}{memory\_page\_status}}[page\_cnt + i], 0, \textcolor{keyword}{sizeof}(\mbox{\hyperlink{internal__ram_8c_a621e270e74e7cd76f8a307554fecc7f4}{heap\_ptr}}-\/>\mbox{\hyperlink{structheap__struct_ad0015b8e38985ffcc758c33e5fab5767}{memory\_page\_status}}[page\_cnt + i]));}
\DoxyCodeLine{61             \}}
\DoxyCodeLine{62         \}}
\DoxyCodeLine{63     \}}
\DoxyCodeLine{64 \}}

\end{DoxyCode}
\mbox{\Hypertarget{internal__ram_8c_a9900c57ec6823ee4290b04f672955b20}\label{internal__ram_8c_a9900c57ec6823ee4290b04f672955b20}} 
\index{internal\_ram.c@{internal\_ram.c}!malloc\_ram\_pages@{malloc\_ram\_pages}}
\index{malloc\_ram\_pages@{malloc\_ram\_pages}!internal\_ram.c@{internal\_ram.c}}
\doxysubsubsection{\texorpdfstring{malloc\_ram\_pages()}{malloc\_ram\_pages()}}
{\footnotesize\ttfamily uint8\+\_\+t$\ast$ malloc\+\_\+ram\+\_\+pages (\begin{DoxyParamCaption}\item[{uint32\+\_\+t}]{size }\end{DoxyParamCaption})}



Выделяет свободную память во внутреннем ОЗУ (страницы памяти) -\/ необходима для реализации кучи 

Функция выделения свободной памяти во внешнем ОЗУ (страниц памяти) 
\begin{DoxyCode}{0}
\DoxyCodeLine{15 \{}
\DoxyCodeLine{16     uint32\_t page\_num = size/\mbox{\hyperlink{internal__ram_8h_a7d467c1d283fdfa1f2081ba1e0d01b6e}{PAGE\_SIZE}} + 1; \textcolor{comment}{// Кол-\/во выделяемых страниц}}
\DoxyCodeLine{17     uint32\_t page\_cnt; \textcolor{comment}{// Счетчик страниц}}
\DoxyCodeLine{18     uint32\_t consecutive\_page\_cnt; \textcolor{comment}{// Счетчик подряд идущих пустых страниц}}
\DoxyCodeLine{19      }
\DoxyCodeLine{20     \textcolor{keywordflow}{for} (page\_cnt = 0; (page\_cnt + page\_num) < \mbox{\hyperlink{internal__ram_8h_a7d467c1d283fdfa1f2081ba1e0d01b6e}{PAGE\_SIZE}}; page\_cnt++)}
\DoxyCodeLine{21     \{}
\DoxyCodeLine{22         \textcolor{comment}{// Проверяем, что подряд идут пустые страницы памяти}}
\DoxyCodeLine{23         \textcolor{keywordflow}{for} (consecutive\_page\_cnt = 0; consecutive\_page\_cnt < page\_num; consecutive\_page\_cnt++)}
\DoxyCodeLine{24         \{}
\DoxyCodeLine{25             \textcolor{keywordflow}{if} (\mbox{\hyperlink{internal__ram_8c_a621e270e74e7cd76f8a307554fecc7f4}{heap\_ptr}}-\/>\mbox{\hyperlink{structheap__struct_ad0015b8e38985ffcc758c33e5fab5767}{memory\_page\_status}}[page\_cnt + consecutive\_page\_cnt] != 0)}
\DoxyCodeLine{26             \{}
\DoxyCodeLine{27                 page\_cnt += consecutive\_page\_cnt;}
\DoxyCodeLine{28                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{29             \}}
\DoxyCodeLine{30         \}}
\DoxyCodeLine{31         \textcolor{comment}{// Если удалось найти требуемое кол-\/во подряд идущих пустых страницы, то возвращаяем указатель}}
\DoxyCodeLine{32         \textcolor{keywordflow}{if} (consecutive\_page\_cnt == page\_num)   }
\DoxyCodeLine{33         \{}
\DoxyCodeLine{34             \textcolor{comment}{// Обновляем статус страниц}}
\DoxyCodeLine{35             \textcolor{keywordflow}{for} (consecutive\_page\_cnt = 0; consecutive\_page\_cnt < page\_num; consecutive\_page\_cnt++)}
\DoxyCodeLine{36             \{}
\DoxyCodeLine{37                 memset(\&\mbox{\hyperlink{internal__ram_8c_a621e270e74e7cd76f8a307554fecc7f4}{heap\_ptr}}-\/>\mbox{\hyperlink{structheap__struct_ad0015b8e38985ffcc758c33e5fab5767}{memory\_page\_status}}[page\_cnt + consecutive\_page\_cnt], 1, \textcolor{keyword}{sizeof}(\mbox{\hyperlink{internal__ram_8c_a621e270e74e7cd76f8a307554fecc7f4}{heap\_ptr}}-\/>\mbox{\hyperlink{structheap__struct_ad0015b8e38985ffcc758c33e5fab5767}{memory\_page\_status}}[page\_cnt + consecutive\_page\_cnt]));}
\DoxyCodeLine{38             \}}
\DoxyCodeLine{39             \textcolor{keywordflow}{return} \&\mbox{\hyperlink{internal__ram_8c_a621e270e74e7cd76f8a307554fecc7f4}{heap\_ptr}}-\/>\mbox{\hyperlink{structheap__struct_ab5c0c2d3e10e4006b923fc5b13a0ee68}{memory\_page\_space}}[page\_cnt][0];}
\DoxyCodeLine{40         \}}
\DoxyCodeLine{41     \}}
\DoxyCodeLine{42     }
\DoxyCodeLine{43     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{44 \}}

\end{DoxyCode}


\doxysubsection{Переменные}
\mbox{\Hypertarget{internal__ram_8c_a621e270e74e7cd76f8a307554fecc7f4}\label{internal__ram_8c_a621e270e74e7cd76f8a307554fecc7f4}} 
\index{internal\_ram.c@{internal\_ram.c}!heap\_ptr@{heap\_ptr}}
\index{heap\_ptr@{heap\_ptr}!internal\_ram.c@{internal\_ram.c}}
\doxysubsubsection{\texorpdfstring{heap\_ptr}{heap\_ptr}}
{\footnotesize\ttfamily \mbox{\hyperlink{internal__ram_8h_a628e9e5cf3cfb53a3445c0b68df42b0c}{int\+\_\+ram\+\_\+heap}}$\ast$ heap\+\_\+ptr\hspace{0.3cm}{\ttfamily [extern]}}



Указатель на \char`\"{}самодельную\char`\"{} кучу 

